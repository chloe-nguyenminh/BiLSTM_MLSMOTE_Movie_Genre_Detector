{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"WGFs64pt0fo7"},"outputs":[],"source":["import keras\n","from keras.models import Sequential\n","from keras.layers import Dense, Dropout, Flatten\n","from keras.layers import Conv2D, MaxPooling2D\n","import keras.utils as image\n","from keras.callbacks import EarlyStopping\n","from keras.callbacks import ModelCheckpoint\n","from keras.preprocessing.image import ImageDataGenerator\n","import pandas as pd\n","import numpy as np\n","from tqdm import tqdm\n","import matplotlib.pyplot as plt\n","import cv2\n","from keras import models\n","from keras import layers\n","from keras import optimizers\n","from PIL import Image\n","import sklearn\n","from sklearn.model_selection import train_test_split\n","from statistics import mean"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18146,"status":"ok","timestamp":1690478246767,"user":{"displayName":"Artificial Intelligence","userId":"02779463696550828437"},"user_tz":240},"id":"2kSEwXKt02Gj","outputId":"caa491fe-3661-45f2-edda-cb7b36213525"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5484,"status":"ok","timestamp":1690478252237,"user":{"displayName":"Artificial Intelligence","userId":"02779463696550828437"},"user_tz":240},"id":"RDpmDhZo0qlF","outputId":"6af7fb9f-7df6-4a57-ed86-53a32fe00b45"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting npy-append-array\n","  Downloading npy_append_array-0.9.16-py3-none-any.whl (9.0 kB)\n","Installing collected packages: npy-append-array\n","Successfully installed npy-append-array-0.9.16\n"]}],"source":["pip install npy-append-array"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YOBCkB7K0qnQ"},"outputs":[],"source":["from npy_append_array import NpyAppendArray"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1b8lVObA0qbM"},"outputs":[],"source":["import csv\n","def arrange_data(df, filename: str):\n","\n","    img_paths = np.asarray(df.iloc[:, 0]) #First column is the image paths\n","    with NpyAppendArray(filename) as outfile:\n","      for i in tqdm(range(len(img_paths))):\n","          try:\n","            img = image.load_img(img_paths[i],target_size=(200,150,3))\n","            img = image.img_to_array(img)\n","            img = img/255\n","            outfile.append(np.array([img.tolist()]))\n","            print(i)\n","          except Exception as e:\n","            print(e)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Rd-bWDYF0qpq"},"outputs":[],"source":["train_filename = '/content/drive/MyDrive/Summer_2023/Models/Poster_Models/X_Train.npy'\n","print(\"Processing train..\")\n","train_df = pd.read_csv(\"/content/drive/MyDrive/Summer_2023/Models/Poster_Models/Train.csv\", delimiter=\" \")\n","arrange_data(train_df, train_filename)\n","\n","Y_train = np.array(train_df.iloc[:,1:29])\n","yt_fn = '/content/drive/MyDrive/Summer_2023/Models/Poster_Models/Y_Train.npy'\n","np.save(yt_fn, Y_train)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z0Okmg-8Ybhf","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1690429034660,"user_tz":240,"elapsed":63816,"user":{"displayName":"Artificial Intelligence","userId":"02779463696550828437"}},"outputId":"cbcf3ae4-cf8d-4047-c903-253d5be03a26"},"outputs":[{"output_type":"stream","name":"stdout","text":["9180\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9182/9386 [46:54<00:54,  3.75it/s]"]},{"output_type":"stream","name":"stdout","text":["9181\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9183/9386 [46:55<01:10,  2.90it/s]"]},{"output_type":"stream","name":"stdout","text":["9182\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9184/9386 [46:55<01:05,  3.07it/s]"]},{"output_type":"stream","name":"stdout","text":["9183\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9185/9386 [46:55<01:03,  3.18it/s]"]},{"output_type":"stream","name":"stdout","text":["9184\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9186/9386 [46:56<01:02,  3.21it/s]"]},{"output_type":"stream","name":"stdout","text":["9185\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9187/9386 [46:56<00:56,  3.54it/s]"]},{"output_type":"stream","name":"stdout","text":["9186\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9188/9386 [46:56<00:53,  3.69it/s]"]},{"output_type":"stream","name":"stdout","text":["9187\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9189/9386 [46:57<01:11,  2.74it/s]"]},{"output_type":"stream","name":"stdout","text":["9188\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9190/9386 [46:57<01:08,  2.87it/s]"]},{"output_type":"stream","name":"stdout","text":["9189\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9191/9386 [46:57<01:01,  3.15it/s]"]},{"output_type":"stream","name":"stdout","text":["9190\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9192/9386 [46:57<00:57,  3.38it/s]"]},{"output_type":"stream","name":"stdout","text":["9191\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9193/9386 [46:58<01:10,  2.73it/s]"]},{"output_type":"stream","name":"stdout","text":["9192\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9194/9386 [46:58<01:08,  2.80it/s]"]},{"output_type":"stream","name":"stdout","text":["9193\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9195/9386 [46:59<01:00,  3.13it/s]"]},{"output_type":"stream","name":"stdout","text":["9194\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9196/9386 [46:59<00:57,  3.28it/s]"]},{"output_type":"stream","name":"stdout","text":["9195\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9197/9386 [46:59<00:54,  3.49it/s]"]},{"output_type":"stream","name":"stdout","text":["9196\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9198/9386 [47:00<01:09,  2.69it/s]"]},{"output_type":"stream","name":"stdout","text":["9197\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9199/9386 [47:00<01:05,  2.85it/s]"]},{"output_type":"stream","name":"stdout","text":["9198\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9200/9386 [47:00<00:58,  3.19it/s]"]},{"output_type":"stream","name":"stdout","text":["9199\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9201/9386 [47:00<00:53,  3.47it/s]"]},{"output_type":"stream","name":"stdout","text":["9200\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9202/9386 [47:01<01:11,  2.58it/s]"]},{"output_type":"stream","name":"stdout","text":["9201\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9203/9386 [47:01<01:04,  2.83it/s]"]},{"output_type":"stream","name":"stdout","text":["9202\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9204/9386 [47:02<00:58,  3.09it/s]"]},{"output_type":"stream","name":"stdout","text":["9203\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9205/9386 [47:02<00:57,  3.15it/s]"]},{"output_type":"stream","name":"stdout","text":["9204\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9206/9386 [47:02<01:01,  2.91it/s]"]},{"output_type":"stream","name":"stdout","text":["9205\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9207/9386 [47:03<01:13,  2.45it/s]"]},{"output_type":"stream","name":"stdout","text":["9206\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9208/9386 [47:03<01:03,  2.81it/s]"]},{"output_type":"stream","name":"stdout","text":["9207\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9210/9386 [47:03<00:49,  3.56it/s]"]},{"output_type":"stream","name":"stdout","text":["9208\n","9209\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9212/9386 [47:04<00:49,  3.48it/s]"]},{"output_type":"stream","name":"stdout","text":["9210\n","9211\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9213/9386 [47:04<00:45,  3.83it/s]"]},{"output_type":"stream","name":"stdout","text":["9212\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9215/9386 [47:05<00:39,  4.31it/s]"]},{"output_type":"stream","name":"stdout","text":["9213\n","9214\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9216/9386 [47:05<00:49,  3.44it/s]"]},{"output_type":"stream","name":"stdout","text":["9215\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9217/9386 [47:05<00:47,  3.54it/s]"]},{"output_type":"stream","name":"stdout","text":["9216\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9219/9386 [47:06<00:40,  4.08it/s]"]},{"output_type":"stream","name":"stdout","text":["9217\n","9218\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9220/9386 [47:06<00:38,  4.26it/s]"]},{"output_type":"stream","name":"stdout","text":["9219\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9221/9386 [47:06<00:48,  3.38it/s]"]},{"output_type":"stream","name":"stdout","text":["9220\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9222/9386 [47:07<00:47,  3.48it/s]"]},{"output_type":"stream","name":"stdout","text":["9221\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9223/9386 [47:07<00:44,  3.64it/s]"]},{"output_type":"stream","name":"stdout","text":["9222\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9224/9386 [47:07<00:42,  3.85it/s]"]},{"output_type":"stream","name":"stdout","text":["9223\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9225/9386 [47:08<00:50,  3.16it/s]"]},{"output_type":"stream","name":"stdout","text":["9224\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9226/9386 [47:08<00:47,  3.36it/s]"]},{"output_type":"stream","name":"stdout","text":["9225\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9227/9386 [47:08<00:43,  3.62it/s]"]},{"output_type":"stream","name":"stdout","text":["9226\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9229/9386 [47:09<00:38,  4.12it/s]"]},{"output_type":"stream","name":"stdout","text":["9227\n","9228\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9230/9386 [47:09<00:47,  3.25it/s]"]},{"output_type":"stream","name":"stdout","text":["9229\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9232/9386 [47:09<00:39,  3.92it/s]"]},{"output_type":"stream","name":"stdout","text":["9230\n","9231\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9234/9386 [47:10<00:36,  4.16it/s]"]},{"output_type":"stream","name":"stdout","text":["9232\n","9233\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9235/9386 [47:10<00:36,  4.17it/s]"]},{"output_type":"stream","name":"stdout","text":["9234\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9236/9386 [47:11<00:49,  3.04it/s]"]},{"output_type":"stream","name":"stdout","text":["9235\n"]},{"output_type":"stream","name":"stderr","text":[" 98%|█████████▊| 9238/9386 [47:11<00:39,  3.79it/s]"]},{"output_type":"stream","name":"stdout","text":["9236\n","9237\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9239/9386 [47:11<00:36,  3.98it/s]"]},{"output_type":"stream","name":"stdout","text":["9238\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9240/9386 [47:12<00:48,  3.03it/s]"]},{"output_type":"stream","name":"stdout","text":["9239\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9241/9386 [47:12<00:43,  3.36it/s]"]},{"output_type":"stream","name":"stdout","text":["9240\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9242/9386 [47:12<00:43,  3.28it/s]"]},{"output_type":"stream","name":"stdout","text":["9241\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9243/9386 [47:13<00:41,  3.49it/s]"]},{"output_type":"stream","name":"stdout","text":["9242\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9244/9386 [47:13<00:42,  3.33it/s]"]},{"output_type":"stream","name":"stdout","text":["9243\n"]},{"output_type":"stream","name":"stderr","text":["\r 98%|█████████▊| 9245/9386 [47:13<00:53,  2.64it/s]"]},{"output_type":"stream","name":"stdout","text":["9244\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9246/9386 [47:14<00:48,  2.89it/s]"]},{"output_type":"stream","name":"stdout","text":["9245\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9247/9386 [47:14<00:44,  3.13it/s]"]},{"output_type":"stream","name":"stdout","text":["9246\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9248/9386 [47:14<00:40,  3.38it/s]"]},{"output_type":"stream","name":"stdout","text":["9247\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9249/9386 [47:15<00:39,  3.46it/s]"]},{"output_type":"stream","name":"stdout","text":["9248\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9250/9386 [47:15<00:49,  2.72it/s]"]},{"output_type":"stream","name":"stdout","text":["9249\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9251/9386 [47:15<00:44,  3.07it/s]"]},{"output_type":"stream","name":"stdout","text":["9250\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9252/9386 [47:16<00:42,  3.16it/s]"]},{"output_type":"stream","name":"stdout","text":["9251\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9253/9386 [47:16<00:40,  3.32it/s]"]},{"output_type":"stream","name":"stdout","text":["9252\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9254/9386 [47:16<00:40,  3.22it/s]"]},{"output_type":"stream","name":"stdout","text":["9253\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9255/9386 [47:17<00:52,  2.51it/s]"]},{"output_type":"stream","name":"stdout","text":["9254\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9256/9386 [47:17<00:45,  2.86it/s]"]},{"output_type":"stream","name":"stdout","text":["9255\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9257/9386 [47:17<00:41,  3.13it/s]"]},{"output_type":"stream","name":"stdout","text":["9256\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9258/9386 [47:18<00:39,  3.25it/s]"]},{"output_type":"stream","name":"stdout","text":["9257\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9259/9386 [47:18<00:49,  2.59it/s]"]},{"output_type":"stream","name":"stdout","text":["9258\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9260/9386 [47:18<00:43,  2.87it/s]"]},{"output_type":"stream","name":"stdout","text":["9259\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9261/9386 [47:19<00:42,  2.94it/s]"]},{"output_type":"stream","name":"stdout","text":["9260\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9262/9386 [47:19<00:39,  3.15it/s]"]},{"output_type":"stream","name":"stdout","text":["9261\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9263/9386 [47:19<00:36,  3.34it/s]"]},{"output_type":"stream","name":"stdout","text":["9262\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9264/9386 [47:20<00:44,  2.73it/s]"]},{"output_type":"stream","name":"stdout","text":["9263\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9265/9386 [47:20<00:39,  3.10it/s]"]},{"output_type":"stream","name":"stdout","text":["9264\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9266/9386 [47:20<00:36,  3.30it/s]"]},{"output_type":"stream","name":"stdout","text":["9265\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9267/9386 [47:20<00:34,  3.43it/s]"]},{"output_type":"stream","name":"stdout","text":["9266\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▊| 9268/9386 [47:21<00:33,  3.52it/s]"]},{"output_type":"stream","name":"stdout","text":["9267\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9269/9386 [47:21<00:38,  3.02it/s]"]},{"output_type":"stream","name":"stdout","text":["9268\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9270/9386 [47:21<00:34,  3.39it/s]"]},{"output_type":"stream","name":"stdout","text":["9269\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9271/9386 [47:22<00:33,  3.44it/s]"]},{"output_type":"stream","name":"stdout","text":["9270\n"]},{"output_type":"stream","name":"stderr","text":[" 99%|█████████▉| 9273/9386 [47:22<00:28,  3.90it/s]"]},{"output_type":"stream","name":"stdout","text":["9271\n","9272\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9274/9386 [47:23<00:34,  3.22it/s]"]},{"output_type":"stream","name":"stdout","text":["9273\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9275/9386 [47:23<00:31,  3.57it/s]"]},{"output_type":"stream","name":"stdout","text":["9274\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9276/9386 [47:23<00:30,  3.57it/s]"]},{"output_type":"stream","name":"stdout","text":["9275\n"]},{"output_type":"stream","name":"stderr","text":[" 99%|█████████▉| 9278/9386 [47:24<00:26,  4.08it/s]"]},{"output_type":"stream","name":"stdout","text":["9276\n","9277\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9279/9386 [47:24<00:34,  3.11it/s]"]},{"output_type":"stream","name":"stdout","text":["9278\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9280/9386 [47:24<00:32,  3.23it/s]"]},{"output_type":"stream","name":"stdout","text":["9279\n"]},{"output_type":"stream","name":"stderr","text":[" 99%|█████████▉| 9282/9386 [47:25<00:26,  3.94it/s]"]},{"output_type":"stream","name":"stdout","text":["9280\n","9281\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9283/9386 [47:25<00:27,  3.72it/s]"]},{"output_type":"stream","name":"stdout","text":["9282\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9284/9386 [47:25<00:27,  3.75it/s]"]},{"output_type":"stream","name":"stdout","text":["9283\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9285/9386 [47:26<00:32,  3.09it/s]"]},{"output_type":"stream","name":"stdout","text":["9284\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9286/9386 [47:26<00:32,  3.09it/s]"]},{"output_type":"stream","name":"stdout","text":["9285\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9287/9386 [47:26<00:30,  3.27it/s]"]},{"output_type":"stream","name":"stdout","text":["9286\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9288/9386 [47:27<00:27,  3.53it/s]"]},{"output_type":"stream","name":"stdout","text":["9287\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9289/9386 [47:27<00:34,  2.84it/s]"]},{"output_type":"stream","name":"stdout","text":["9288\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9290/9386 [47:27<00:31,  3.07it/s]"]},{"output_type":"stream","name":"stdout","text":["9289\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9291/9386 [47:28<00:29,  3.27it/s]"]},{"output_type":"stream","name":"stdout","text":["9290\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9292/9386 [47:28<00:27,  3.45it/s]"]},{"output_type":"stream","name":"stdout","text":["9291\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9293/9386 [47:28<00:26,  3.49it/s]"]},{"output_type":"stream","name":"stdout","text":["9292\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9294/9386 [47:29<00:31,  2.96it/s]"]},{"output_type":"stream","name":"stdout","text":["9293\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9295/9386 [47:29<00:28,  3.17it/s]"]},{"output_type":"stream","name":"stdout","text":["9294\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9296/9386 [47:29<00:26,  3.36it/s]"]},{"output_type":"stream","name":"stdout","text":["9295\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9297/9386 [47:29<00:26,  3.41it/s]"]},{"output_type":"stream","name":"stdout","text":["9296\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9298/9386 [47:30<00:31,  2.77it/s]"]},{"output_type":"stream","name":"stdout","text":["9297\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9299/9386 [47:30<00:30,  2.88it/s]"]},{"output_type":"stream","name":"stdout","text":["9298\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9300/9386 [47:30<00:28,  3.06it/s]"]},{"output_type":"stream","name":"stdout","text":["9299\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9301/9386 [47:31<00:25,  3.28it/s]"]},{"output_type":"stream","name":"stdout","text":["9300\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9302/9386 [47:31<00:23,  3.50it/s]"]},{"output_type":"stream","name":"stdout","text":["9301\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9303/9386 [47:32<00:31,  2.61it/s]"]},{"output_type":"stream","name":"stdout","text":["9302\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9304/9386 [47:32<00:28,  2.85it/s]"]},{"output_type":"stream","name":"stdout","text":["9303\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9305/9386 [47:32<00:26,  3.11it/s]"]},{"output_type":"stream","name":"stdout","text":["9304\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9306/9386 [47:32<00:23,  3.36it/s]"]},{"output_type":"stream","name":"stdout","text":["9305\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9307/9386 [47:33<00:29,  2.66it/s]"]},{"output_type":"stream","name":"stdout","text":["9306\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9308/9386 [47:33<00:27,  2.82it/s]"]},{"output_type":"stream","name":"stdout","text":["9307\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9309/9386 [47:34<00:25,  2.99it/s]"]},{"output_type":"stream","name":"stdout","text":["9308\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9310/9386 [47:34<00:23,  3.19it/s]"]},{"output_type":"stream","name":"stdout","text":["9309\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9311/9386 [47:34<00:22,  3.38it/s]"]},{"output_type":"stream","name":"stdout","text":["9310\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9312/9386 [47:35<00:28,  2.62it/s]"]},{"output_type":"stream","name":"stdout","text":["9311\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9313/9386 [47:35<00:24,  3.01it/s]"]},{"output_type":"stream","name":"stdout","text":["9312\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9314/9386 [47:35<00:22,  3.22it/s]"]},{"output_type":"stream","name":"stdout","text":["9313\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9315/9386 [47:35<00:21,  3.34it/s]"]},{"output_type":"stream","name":"stdout","text":["9314\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9316/9386 [47:36<00:20,  3.45it/s]"]},{"output_type":"stream","name":"stdout","text":["9315\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9317/9386 [47:36<00:25,  2.67it/s]"]},{"output_type":"stream","name":"stdout","text":["9316\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9318/9386 [47:36<00:23,  2.95it/s]"]},{"output_type":"stream","name":"stdout","text":["9317\n","9318"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9319/9386 [47:37<00:20,  3.35it/s]"]},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9320/9386 [47:37<00:18,  3.62it/s]"]},{"output_type":"stream","name":"stdout","text":["9319\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9321/9386 [47:37<00:17,  3.72it/s]"]},{"output_type":"stream","name":"stdout","text":["9320\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9322/9386 [47:38<00:22,  2.88it/s]"]},{"output_type":"stream","name":"stdout","text":["9321\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9323/9386 [47:38<00:20,  3.10it/s]"]},{"output_type":"stream","name":"stdout","text":["9322\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9324/9386 [47:38<00:18,  3.43it/s]"]},{"output_type":"stream","name":"stdout","text":["9323\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9325/9386 [47:38<00:16,  3.77it/s]"]},{"output_type":"stream","name":"stdout","text":["9324\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9326/9386 [47:39<00:18,  3.20it/s]"]},{"output_type":"stream","name":"stdout","text":["9325\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9327/9386 [47:39<00:17,  3.34it/s]"]},{"output_type":"stream","name":"stdout","text":["9326\n"]},{"output_type":"stream","name":"stderr","text":[" 99%|█████████▉| 9329/9386 [47:39<00:14,  3.87it/s]"]},{"output_type":"stream","name":"stdout","text":["9327\n","9328\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9330/9386 [47:40<00:13,  4.11it/s]"]},{"output_type":"stream","name":"stdout","text":["9329\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9331/9386 [47:40<00:18,  3.04it/s]"]},{"output_type":"stream","name":"stdout","text":["9330\n"]},{"output_type":"stream","name":"stderr","text":[" 99%|█████████▉| 9333/9386 [47:41<00:14,  3.65it/s]"]},{"output_type":"stream","name":"stdout","text":["9331\n","9332\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9334/9386 [47:41<00:13,  3.79it/s]"]},{"output_type":"stream","name":"stdout","text":["9333\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9335/9386 [47:41<00:13,  3.72it/s]"]},{"output_type":"stream","name":"stdout","text":["9334\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9336/9386 [47:42<00:16,  3.10it/s]"]},{"output_type":"stream","name":"stdout","text":["9335\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9337/9386 [47:42<00:15,  3.23it/s]"]},{"output_type":"stream","name":"stdout","text":["9336\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9338/9386 [47:42<00:13,  3.60it/s]"]},{"output_type":"stream","name":"stdout","text":["9337\n"]},{"output_type":"stream","name":"stderr","text":["\r 99%|█████████▉| 9339/9386 [47:42<00:12,  3.79it/s]"]},{"output_type":"stream","name":"stdout","text":["9338\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9340/9386 [47:43<00:15,  2.98it/s]"]},{"output_type":"stream","name":"stdout","text":["9339\n"]},{"output_type":"stream","name":"stderr","text":["100%|█████████▉| 9342/9386 [47:43<00:12,  3.61it/s]"]},{"output_type":"stream","name":"stdout","text":["9340\n","9341\n"]},{"output_type":"stream","name":"stderr","text":["100%|█████████▉| 9344/9386 [47:44<00:10,  4.06it/s]"]},{"output_type":"stream","name":"stdout","text":["9342\n","9343\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9345/9386 [47:44<00:12,  3.30it/s]"]},{"output_type":"stream","name":"stdout","text":["9344\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9346/9386 [47:45<00:12,  3.30it/s]"]},{"output_type":"stream","name":"stdout","text":["9345\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9347/9386 [47:45<00:10,  3.62it/s]"]},{"output_type":"stream","name":"stdout","text":["9346\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9348/9386 [47:45<00:09,  3.89it/s]"]},{"output_type":"stream","name":"stdout","text":["9347\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9349/9386 [47:45<00:09,  3.93it/s]"]},{"output_type":"stream","name":"stdout","text":["9348\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9350/9386 [47:46<00:12,  2.99it/s]"]},{"output_type":"stream","name":"stdout","text":["9349\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9351/9386 [47:46<00:10,  3.31it/s]"]},{"output_type":"stream","name":"stdout","text":["9350\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9352/9386 [47:46<00:10,  3.39it/s]"]},{"output_type":"stream","name":"stdout","text":["9351\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9353/9386 [47:46<00:09,  3.60it/s]"]},{"output_type":"stream","name":"stdout","text":["9352\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9354/9386 [47:47<00:09,  3.54it/s]"]},{"output_type":"stream","name":"stdout","text":["9353\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9355/9386 [47:47<00:11,  2.75it/s]"]},{"output_type":"stream","name":"stdout","text":["9354\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9356/9386 [47:48<00:10,  2.79it/s]"]},{"output_type":"stream","name":"stdout","text":["9355\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9357/9386 [47:48<00:09,  2.99it/s]"]},{"output_type":"stream","name":"stdout","text":["9356\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9358/9386 [47:48<00:08,  3.28it/s]"]},{"output_type":"stream","name":"stdout","text":["9357\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9359/9386 [47:49<00:10,  2.59it/s]"]},{"output_type":"stream","name":"stdout","text":["9358\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9360/9386 [47:49<00:09,  2.87it/s]"]},{"output_type":"stream","name":"stdout","text":["9359\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9361/9386 [47:49<00:08,  2.96it/s]"]},{"output_type":"stream","name":"stdout","text":["9360\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9362/9386 [47:50<00:07,  3.20it/s]"]},{"output_type":"stream","name":"stdout","text":["9361\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9363/9386 [47:50<00:06,  3.40it/s]"]},{"output_type":"stream","name":"stdout","text":["9362\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9364/9386 [47:50<00:08,  2.51it/s]"]},{"output_type":"stream","name":"stdout","text":["9363\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9365/9386 [47:51<00:07,  2.84it/s]"]},{"output_type":"stream","name":"stdout","text":["9364\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9366/9386 [47:51<00:06,  2.99it/s]"]},{"output_type":"stream","name":"stdout","text":["9365\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9367/9386 [47:51<00:06,  3.07it/s]"]},{"output_type":"stream","name":"stdout","text":["9366\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9368/9386 [47:52<00:05,  3.12it/s]"]},{"output_type":"stream","name":"stdout","text":["9367\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9369/9386 [47:52<00:07,  2.37it/s]"]},{"output_type":"stream","name":"stdout","text":["9368\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9370/9386 [47:52<00:05,  2.72it/s]"]},{"output_type":"stream","name":"stdout","text":["9369\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9371/9386 [47:53<00:04,  3.01it/s]"]},{"output_type":"stream","name":"stdout","text":["9370\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9372/9386 [47:53<00:04,  3.27it/s]"]},{"output_type":"stream","name":"stdout","text":["9371\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9373/9386 [47:53<00:03,  3.44it/s]"]},{"output_type":"stream","name":"stdout","text":["9372\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9374/9386 [47:54<00:04,  2.83it/s]"]},{"output_type":"stream","name":"stdout","text":["9373\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9375/9386 [47:54<00:03,  3.03it/s]"]},{"output_type":"stream","name":"stdout","text":["9374\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9376/9386 [47:54<00:03,  2.88it/s]"]},{"output_type":"stream","name":"stdout","text":["9375\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9377/9386 [47:55<00:02,  3.03it/s]"]},{"output_type":"stream","name":"stdout","text":["9376\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9378/9386 [47:55<00:02,  3.14it/s]"]},{"output_type":"stream","name":"stdout","text":["9377\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9379/9386 [47:56<00:02,  2.62it/s]"]},{"output_type":"stream","name":"stdout","text":["9378\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9380/9386 [47:56<00:01,  3.01it/s]"]},{"output_type":"stream","name":"stdout","text":["9379\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9381/9386 [47:56<00:01,  3.19it/s]"]},{"output_type":"stream","name":"stdout","text":["9380\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9382/9386 [47:56<00:01,  3.40it/s]"]},{"output_type":"stream","name":"stdout","text":["9381\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9383/9386 [47:57<00:00,  3.46it/s]"]},{"output_type":"stream","name":"stdout","text":["9382\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9384/9386 [47:57<00:00,  2.80it/s]"]},{"output_type":"stream","name":"stdout","text":["9383\n"]},{"output_type":"stream","name":"stderr","text":["\r100%|█████████▉| 9385/9386 [47:57<00:00,  3.16it/s]"]},{"output_type":"stream","name":"stdout","text":["9384\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 9386/9386 [47:58<00:00,  3.26it/s]"]},{"output_type":"stream","name":"stdout","text":["9385\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["valid_filename = '/content/drive/MyDrive/Summer_2023/Models/Poster_Models/X_Val.npy'\n","print(\"Processing validation..\")\n","val_df = pd.read_csv(\"/content/drive/MyDrive/Summer_2023/Models/Poster_Models/Valid.csv\", delimiter=\" \")\n","arrange_data(val_df, valid_filename)\n","\n","Y_Val = np.array(val_df.iloc[:,1:29])\n","yv_fn = '/content/drive/MyDrive/Summer_2023/Models/Poster_Models/Y_Val.npy'\n","np.save(yv_fn, Y_Val)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sDA8o5XaksYH"},"outputs":[],"source":["X_Train = np.load('/content/drive/MyDrive/Summer_2023/Models/Poster_Models/X_Train.npy', mmap_mode = 'r')\n","Y_Train = np.load('/content/drive/MyDrive/Summer_2023/Models/Poster_Models/Y_Train.npy', mmap_mode = 'r')"]},{"cell_type":"code","source":["print(X_Train.shape)\n","print(Y_Train.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WcHnhfTNP7lW","executionInfo":{"status":"ok","timestamp":1690478266952,"user_tz":240,"elapsed":163,"user":{"displayName":"Artificial Intelligence","userId":"02779463696550828437"}},"outputId":"54ba9739-43fb-47cc-ff4b-ad67d254ecda"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["(24335, 200, 150, 3)\n","(24335, 28)\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kXNHjsSneRe7"},"outputs":[],"source":["X_Val = np.load('/content/drive/MyDrive/Summer_2023/Models/Poster_Models/X_Val.npy', mmap_mode = 'r')\n","Y_Val = np.load('/content/drive/MyDrive/Summer_2023/Models/Poster_Models/Y_Val.npy', mmap_mode = 'r')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Opv9_F9pfi7T","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1690478272737,"user_tz":240,"elapsed":179,"user":{"displayName":"Artificial Intelligence","userId":"02779463696550828437"}},"outputId":"dda3ef11-e99f-459a-bc3a-5716d856ca89"},"outputs":[{"output_type":"stream","name":"stdout","text":["(9386, 200, 150, 3)\n","(9386, 28)\n"]}],"source":["print(X_Val.shape)\n","print(Y_Val.shape)"]}],"metadata":{"accelerator":"TPU","colab":{"provenance":[],"gpuType":"V100","cell_execution_strategy":"setup","authorship_tag":"ABX9TyPG1fyjTWik8p/8pgmfi2ww"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}